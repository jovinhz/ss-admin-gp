"use strict";(self["webpackChunksumatera_soil"]=self["webpackChunksumatera_soil"]||[]).push([[927],{9763:function(t,i,e){e.d(i,{Ay:function(){return o},Mq:function(){return d},ci:function(){return r}});var a=e(9145);const s=new a.Z,o=(t={limit:1e4})=>s.withOptions({showProgressBar:!1}).axiosInstance.get("/administrator/products",{params:t}),d=t=>s.withOptions({showProgressBar:!1}).axiosInstance.get(`/administrator/products/${t}`),r=(t,i)=>s.withOptions({successFeedbackMessage:"Komoditi berhasil diperbarui",showSuccessFeedback:!0}).axiosInstance.put(`/administrator/products/${t}`,i)},1789:function(t,i,e){e.d(i,{CT:function(){return d},rc:function(){return r},w9:function(){return o}});var a=e(9145);const s=new a.Z,o=(t={limit:1e4})=>s.withOptions({showProgressBar:!1}).axiosInstance.get("/administrator/districts",{params:t}),d=t=>s.withOptions({successFeedbackMessage:"Wilayah berhasil ditambahkan",showSuccessFeedback:!0}).axiosInstance.post("/administrator/districts",t),r=(t,i)=>s.withOptions({successFeedbackMessage:"Wilayah berhasil diperbarui",showSuccessFeedback:!0}).axiosInstance.put(`/administrator/districts/${t}`,i)},6705:function(t,i,e){e.d(i,{p:function(){return a}});const a=t=>{const i=[];for(let e=0;e<t.length;e++)i.push({...t[e],seq:e+1});return i}},927:function(t,i,e){e.r(i),e.d(i,{default:function(){return ot}});var a=e(3396);function s(t,i,e,s,o,d){const r=(0,a.up)("Detail"),n=(0,a.up)("PriceList");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{id:t.id},null,8,["id"]),(0,a.Wm)(n,{id:t.id},null,8,["id"])])}const o=(0,a._)("div",{class:"content-title"},[(0,a._)("h5",{class:"m-0"},"Detail Komoditi")],-1),d={class:"row"},r={class:"col-12"},n={class:"card"},l={class:"card-body"},c={class:"row mb-2"},m={class:"col-12 col-md-6"},u={class:"row mb-2"},p={class:"col-12 col-md-6"},h={class:"row mb-2"},f={class:"col-12 col-md-6"},g={class:"row mb mt-3"},_={class:"col-md-6 mb-2"},b=["disabled"],v=(0,a._)("span",{class:"btn-addon"},[(0,a._)("i",{class:"btn-addon-icon fe fe-send"})],-1),w=(0,a.Uk)(" Simpan "),k=[v,w];function S(t,i,e,s,v,w){const S=(0,a.up)("a-input"),y=(0,a.up)("a-form-item"),F=(0,a.up)("a-alert"),W=(0,a.up)("a-input-number"),O=(0,a.up)("a-form"),M=(0,a.up)("a-spin");return(0,a.wg)(),(0,a.iD)("div",null,[o,(0,a.Wm)(M,{spinning:t.loadingGet},{default:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a._)("div",r,[(0,a._)("div",n,[(0,a._)("div",l,[(0,a.Wm)(O,{ref:"formRef",layout:"vertical",model:t.formState,rules:t.formRules,onFinish:t.handleEdit},{default:(0,a.w5)((()=>[(0,a._)("div",c,[(0,a._)("div",m,[(0,a.Wm)(y,{ref:"name",label:"Nama",name:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{value:t.formState.name,"onUpdate:value":i[0]||(i[0]=i=>t.formState.name=i),placeholder:"Nama Komoditi"},null,8,["value"])])),_:1},512)])]),(0,a._)("div",u,[(0,a._)("div",p,[(0,a.Wm)(y,{ref:"unit",label:"Unit",name:"unit"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{value:t.formState.unit,"onUpdate:value":i[1]||(i[1]=i=>t.formState.unit=i),placeholder:"Satuan unit"},null,8,["value"])])),_:1},512)])]),(0,a._)("div",h,[(0,a._)("div",f,[(0,a.Wm)(y,{ref:"kg_to_point",label:"Point Exchange Rate",name:"kg_to_point"},{default:(0,a.w5)((()=>[(0,a.Wm)(F,{class:"mb-4",message:"Rumus",description:"Total point didapat = point exchange rate * total transaksi",type:"info","show-icon":""}),(0,a.Wm)(W,{value:t.formState.kg_to_point,"onUpdate:value":i[2]||(i[2]=i=>t.formState.kg_to_point=i),placeholder:"Exchange rate"},null,8,["value"])])),_:1},512)])]),(0,a._)("div",g,[(0,a._)("div",_,[(0,a._)("button",{type:"submit",class:"btn btn-primary btn-with-addon",disabled:t.loadingSubmit},k,8,b)])])])),_:1},8,["model","rules","onFinish"])])])])])])),_:1},8,["spinning"])])}var y=e(4870),F=e(9763),W=(0,a.aZ)({name:"DetailCommodity",props:{id:String},setup(){const t=(0,y.iH)(),i=(0,y.qj)({name:void 0,unit:void 0,kg_to_point:void 0}),e={name:[{required:!0,trigger:"change",message:"Nama tidak boleh kosong"}],unit:[{required:!0,trigger:"change",message:"Satuan unit tidak boleh kosong"}],kg_to_point:[{required:!0,trigger:"change",message:"Exchange point rate tidak boleh kosong"}]};return{formRef:t,formState:i,formRules:e}},data(){return{commodity:void 0,loadingSubmit:!1,loadingGet:!0}},mounted(){this.fetchCommodity()},methods:{async fetchCommodity(){this.loadingGet=!0;const t=await(0,F.Mq)(this.$props.id);t.data.success&&(this.formState.name=t.data.data.name,this.formState.unit=t.data.data.unit,this.formState.kg_to_point=parseFloat(t.data.data.kg_to_point)),this.loadingGet=!1},async onSubmit(){const t=await(0,F.ci)(this.$props.id,{name:this.formState.name,unit:this.formState.unit,kg_to_point:this.formState.kg_to_point});t.data.success&&(this.formState.name=t.data.data.name,this.formState.unit=t.data.data.unit,this.formState.kg_to_point=parseFloat(t.data.data.kg_to_point))},handleEdit(){this.formRef.validateFields().then((()=>this.onSubmit())).catch((()=>{}))}}}),O=e(89);const M=(0,O.Z)(W,[["render",S]]);var x=M;const H={class:"content-title d-flex align-items-center justify-content-between"},R=(0,a._)("h5",{class:"m-0"},"Daftar Harga",-1),C=(0,a._)("i",{class:"fe fe-plus mr-1"},null,-1),D=(0,a.Uk)(" Tambah "),E=[C,D],I=["onClick"],q=(0,a._)("i",{class:"fe fe-edit"},null,-1),P=[q],U={class:"row"},$={class:"col-12"},A={class:"col-12"},L={class:"col-12"},V={class:"row"},Z={class:"col-12"},T={class:"col-12"},J={class:"col-12"};function j(t,i,e,s,o,d){const r=(0,a.up)("a-table"),n=(0,a.up)("a-input-number"),l=(0,a.up)("a-form-item"),c=(0,a.up)("a-select"),m=(0,a.up)("a-form"),u=(0,a.up)("a-modal");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",H,[R,(0,a._)("div",null,[(0,a._)("button",{class:"btn btn-light",onClick:i[0]||(i[0]=(...i)=>t.openCreateModal&&t.openCreateModal(...i))},E)])]),(0,a.Wm)(r,{columns:t.columns,"data-source":t.dataSource,"row-key":t=>t.id,loading:t.loading,scroll:{y:t.setting.maxTableContentHeight,x:!0}},{bodyCell:(0,a.w5)((({column:i,record:e})=>["action"===i.key?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn btn-sm btn-light",onClick:i=>t.openEditModal(e)},P,8,I)):(0,a.kq)("",!0)])),_:1},8,["columns","data-source","row-key","loading","scroll"]),(0,a.Wm)(u,{class:"form-modal",visible:t.createModalVisible,"onUpdate:visible":i[4]||(i[4]=i=>t.createModalVisible=i),title:"Tambah Harga",confirmLoading:t.loadingAdd,onOk:t.handleAddFinish},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{ref:"formRef",layout:"vertical",model:t.formState,rules:t.formRules,onFinish:t.handleAddFinish},{default:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a._)("div",$,[(0,a.Wm)(l,{ref:"price",label:"Harga",name:"price"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{placeholder:"Harga",value:t.formState.price,"onUpdate:value":i[1]||(i[1]=i=>t.formState.price=i),min:0,step:1e3,style:{width:"100%"}},null,8,["value"])])),_:1},512)]),(0,a._)("div",A,[(0,a.Wm)(l,{ref:"district_id",label:"Wilayah",name:"district_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{ref:"select",style:{width:"100%"},placeholder:"Pilih wilayah",value:t.formState.district_id,"onUpdate:value":i[2]||(i[2]=i=>t.formState.district_id=i),"show-search":"",options:t.districtOptions,"filter-option":t.filterOption},null,8,["value","options","filter-option"])])),_:1},512)]),(0,a._)("div",L,[(0,a.Wm)(l,{ref:"for_id",label:"Jenis",name:"for_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{ref:"select",style:{width:"100%"},placeholder:"Jenis",value:t.formState.for_id,"onUpdate:value":i[3]||(i[3]=i=>t.formState.for_id=i),options:t.priceTypeOptions},null,8,["value","options"])])),_:1},512)])])])),_:1},8,["model","rules","onFinish"])])),_:1},8,["visible","confirmLoading","onOk"]),(0,a.Wm)(u,{class:"form-modal",visible:t.editModalVisible,"onUpdate:visible":i[8]||(i[8]=i=>t.editModalVisible=i),title:"Edit Harga",confirmLoading:t.loadingEdit,onOk:t.handleEditFinish},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{ref:"editFormRef",layout:"vertical",model:t.editFormState,rules:t.formRules,onFinish:t.handleEditFinish},{default:(0,a.w5)((()=>[(0,a._)("div",V,[(0,a._)("div",Z,[(0,a.Wm)(l,{ref:"price",label:"Harga",name:"price"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{placeholder:"Harga",value:t.editFormState.price,"onUpdate:value":i[5]||(i[5]=i=>t.editFormState.price=i),min:0,step:1e3,style:{width:"100%"}},null,8,["value"])])),_:1},512)]),(0,a._)("div",T,[(0,a.Wm)(l,{ref:"district_id",label:"Wilayah",name:"district_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{ref:"select",style:{width:"100%"},placeholder:"Pilih wilayah",value:t.editFormState.district_id,"onUpdate:value":i[6]||(i[6]=i=>t.editFormState.district_id=i),"show-search":"",options:t.districtOptions,"filter-option":t.filterOption},null,8,["value","options","filter-option"])])),_:1},512)]),(0,a._)("div",J,[(0,a.Wm)(l,{ref:"for_id",label:"Jenis",name:"for_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{ref:"select",style:{width:"100%"},placeholder:"Jenis",value:t.editFormState.for_id,"onUpdate:value":i[7]||(i[7]=i=>t.editFormState.for_id=i),options:t.priceTypeOptions},null,8,["value","options"])])),_:1},512)])])])),_:1},8,["model","rules","onFinish"])])),_:1},8,["visible","confirmLoading","onOk"])])}e(6699);var B=e(9145);const G=new B.Z,K=(t,i={limit:1e4})=>G.withOptions({showProgressBar:!1}).axiosInstance.get(`/administrator/products/${t}/product_prices`,{params:i}),N=(t,i)=>G.withOptions({successFeedbackMessage:"Harga komoditi berhasil ditambahkan",showSuccessFeedback:!0}).axiosInstance.post(`administrator/products/${t}/product_prices`,i),Q=(t,i,e)=>G.withOptions({successFeedbackMessage:"Harga komoditi berhasil diperbarui",showSuccessFeedback:!0}).axiosInstance.put(`administrator/products/${t}/product_prices/${i}`,e);var z=e(7417),X=e(6705),Y=e(1789),tt=(0,a.aZ)({name:"PriceList",props:{id:String},setup(){const t=(0,y.iH)(!1),i=()=>{t.value=!0},e=(0,y.iH)(!1),s=(0,z.oR)(),o=(0,a.Fl)((()=>s.getters["Setting/settings"])),d=(0,y.iH)([{title:"#",key:"#",dataIndex:"seq",width:50},{title:"Wilayah",key:"district",dataIndex:["district","name"]},{title:"Harga",key:"formatted_price",dataIndex:"formatted_price"},{title:"Jenis",key:"for",dataIndex:"for_caption"},{title:"Aksi",key:"action"}]),r=(0,y.iH)(),n=(0,y.qj)({district_id:void 0,for_id:void 0,price:void 0}),l={district_id:[{required:!0,trigger:"change",message:"Wilayah tidak boleh kosong"}],for_id:[{required:!0,trigger:"change",message:"Jenis harga tidak boleh kosong"}],price:[{required:!0,trigger:"change",message:"Harga tidak boleh kosong"}]},c=(0,y.iH)(),m=(0,y.qj)({district_id:void 0,for_id:void 0,price:void 0}),u=(0,y.iH)(),p=(t,i)=>i.label.toLowerCase().includes(t.toLocaleLowerCase());return{columns:d,store:s,setting:o,formRef:r,formState:n,editFormRef:c,editFormState:m,formRules:l,createModalVisible:t,editModalVisible:e,focusedPriceId:u,openCreateModal:i,filterOption:p}},computed:{dataSource(){return(0,X.p)(this.rowData)},districtOptions(){return this.districts.map((t=>({value:t.id,label:t.name})))},priceTypeOptions(){return[{value:1,label:"QC"},{value:2,label:"Petani"}]}},mounted(){this.fetchData(),this.fetchDistricts()},data(){return{districts:[],rowData:[],loading:!0,loadingAdd:!1,loadingEdit:!1}},methods:{async fetchDistricts(){const t=await(0,Y.w9)();t.data.success&&(this.districts=t.data.data)},async fetchData(){this.loading=!0;const t=await K(this.$props.id);t.data.success&&(this.rowData=t.data.data),this.loading=!1},async submitAdd(){this.loadingAdd=!0;const t=await N(this.$props.id,{price:this.formState.price,for_id:this.formState.for_id,district_id:this.formState.district_id});t.data.success&&(this.formRef.resetFields(),this.createModalVisible=!1,this.fetchData()),this.loadingAdd=!1},async submitEdit(){this.loadingEdit=!0;const t=await Q(this.$props.id,this.focusedPriceId,{price:this.editFormState.price,district_id:this.editFormState.district_id,for_id:this.editFormState.for_id});t.data.success&&(this.editFormRef.resetFields(),this.editModalVisible=!1,this.fetchData()),this.loadingEdit=!1},handleAddFinish(){this.formRef.validate().then((()=>this.submitAdd())).catch((()=>{}))},handleEditFinish(){this.editFormRef.validate().then((()=>this.submitEdit())).catch((()=>{}))},openEditModal(t){this.focusedPriceId=t.id,this.editFormState.price=parseFloat(t.price),this.editFormState.for_id=t.for_id,this.editFormState.district_id=t.district.id,this.editModalVisible=!0}}});const it=(0,O.Z)(tt,[["render",j]]);var et=it,at=(0,a.aZ)({name:"EditCommodity",props:{id:String},components:{Detail:x,PriceList:et}});const st=(0,O.Z)(at,[["render",s]]);var ot=st}}]);