"use strict";(self["webpackChunksumatera_soil"]=self["webpackChunksumatera_soil"]||[]).push([[170],{1789:function(a,t,e){e.d(t,{CT:function(){return o},rc:function(){return d},w9:function(){return r}});var s=e(9145);const i=new s.Z,r=(a={limit:1e4})=>i.withOptions({showProgressBar:!1}).axiosInstance.get("/administrator/districts",{params:a}),o=a=>i.withOptions({successFeedbackMessage:"Wilayah berhasil ditambahkan",showSuccessFeedback:!0}).axiosInstance.post("/administrator/districts",a),d=(a,t)=>i.withOptions({successFeedbackMessage:"Wilayah berhasil diperbarui",showSuccessFeedback:!0}).axiosInstance.put(`/administrator/districts/${a}`,t)},8726:function(a,t,e){e.d(t,{DY:function(){return r},T:function(){return o},X$:function(){return d},fP:function(){return n},mt:function(){return l}});var s=e(9145);const i=new s.Z,r=(a={limit:1e4})=>i.withOptions({showProgressBar:!1}).axiosInstance.get("/administrator/farmers",{params:a}),o=a=>i.withOptions({showProgressBar:!1}).axiosInstance.get(`/administrator/farmers/${a}`),d=a=>i.withOptions({successFeedbackMessage:"Petani berhasil ditambahkan",showSuccessFeedback:!0}).axiosInstance.post("/administrator/farmers",a),n=(a,t)=>i.withOptions({successFeedbackMessage:"Petani berhasil diperbarui",showSuccessFeedback:!0}).axiosInstance.put(`/administrator/farmers/${a}`,t),l=(a,t={limit:1e5})=>i.withOptions({showProgressBar:!1}).axiosInstance.get(`/administrator/farmers/${a}/farmer_point_logs`,{params:t})},7776:function(a,t,e){e.d(t,{Z:function(){return S}});var s=e(3396),i=e(9242);const r=a=>((0,s.dD)("data-v-1f202da3"),a=a(),(0,s.Cn)(),a),o=["src"],d={key:2},n=r((()=>(0,s._)("div",{class:"ant-upload-text"},"Upload",-1)));function l(a,t,e,r,l,c){const m=(0,s.up)("plus-outlined"),u=(0,s.up)("a-upload"),g=(0,s.up)("a-image");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(u,{name:"icon",listType:"picture-card",accept:".png,.jpg,.jpeg",class:"avatar-uploader-has-overlay","show-upload-list":!1,beforeUpload:()=>!1,onChange:a.onChange},{default:(0,s.w5)((()=>[(0,s._)("div",null,[a.imgUrl?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"avatar-uploader-overlay",onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},[(0,s._)("i",{class:"fe fe-eye mr-2",onClick:t[0]||(t[0]=(0,i.iM)(((...t)=>a.openImgPreview&&a.openImgPreview(...t)),["stop"]))}),(0,s._)("i",{class:"fe fe-trash-2",onClick:t[1]||(t[1]=(0,i.iM)(((...t)=>a.onDelete&&a.onDelete(...t)),["stop"]))})])):(0,s.kq)("",!0),a.imgUrl?((0,s.wg)(),(0,s.iD)("img",{key:1,class:"upload-image-thumbnail",src:a.imgUrl,alt:""},null,8,o)):((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(m),n]))])])),_:1},8,["beforeUpload","onChange"]),(0,s.Wm)(g,{style:{display:"none"},preview:{visible:a.imgPreviewVisible,onVisibleChange:a.imgPreviewVisibleChange},src:a.imgUrl},null,8,["preview","src"])])}var c=e(4870),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},u=m,g=e(9388);function h(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(e).filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})))),s.forEach((function(t){p(a,t,e[t])}))}return a}function p(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var _=function(a,t){var e=h({},a,t.attrs);return(0,s.Wm)(g.Z,h({},e,{icon:u}),null)};_.displayName="PlusOutlined",_.inheritAttrs=!1;var f=_;const w=(a,t)=>{const e=new FileReader;e.addEventListener("load",(()=>t(e.result))),e.readAsDataURL(a)};var v=(0,s.aZ)({name:"UploadImage",props:{imgUrl:String,changeImg:Function},components:{PlusOutlined:f},setup(){const a=(0,c.iH)(!1),t=t=>{a.value=t},e=()=>{a.value=!0};return{imgPreviewVisible:a,imgPreviewVisibleChange:t,openImgPreview:e}},methods:{checkImageUpload(a){const t="image/jpeg"===a.type||"image/png"===a.type||"image/jpeg"===a.type;let e=!0;t||(this.$message.error("Format file tidak didukung"),e=!1);const s=a.size/1024/1024<2;return s||(this.$message.error("Ukuran file terlalu besar"),e=!1),e},onChange(a){this.checkImageUpload(a.file)&&w(a.file,(t=>{this.$emit("changeImg",t,a.file)}))},onDelete(){this.$emit("changeImg","",null)}}}),b=e(89);const k=(0,b.Z)(v,[["render",l],["__scopeId","data-v-1f202da3"]]);var S=k},3170:function(a,t,e){e.r(t),e.d(t,{default:function(){return ba}});var s=e(3396),i=e(7139);const r=(0,s._)("div",{class:"content-title"},[(0,s._)("h5",{class:"m-0"},"Detail Petani")],-1),o={class:"row"},d={class:"col-12 col-md-6"},n={class:"card"},l=(0,s._)("div",{class:"card-header"},[(0,s._)("h6",{class:"mb-0"},"Profil")],-1),c={class:"card-body"},m={class:"row mb-2"},u={class:"col-12"},g={class:"row"},h={class:"col-12"},p={class:"row"},_={class:"col-12"},f={class:"row"},w={class:"col-12"},v={class:"row mb-2"},b={class:"col-6"},k={class:"col-6"},S={class:"row mb-2"},P={class:"col-6"},y={class:"col-6"},F={class:"col-6"},C={class:"row mb mt-3"},W={class:"col-md-6 mb-2"},U=["disabled"],I=(0,s._)("span",{class:"btn-addon"},[(0,s._)("i",{class:"btn-addon-icon fe fe-send"})],-1),D=(0,s.Uk)(" Simpan "),q=[I,D],L={class:"col-12 col-md-6"},O={class:"card"},x=(0,s._)("div",{class:"card-header"},[(0,s._)("h6",{class:"mb-0"},"Info")],-1),R={class:"card-body"},j={class:"row mb-3"},$=(0,s._)("div",{class:"col-12 col-sm-3"},[(0,s._)("span",null,"Status")],-1),H={class:"col-12 col-sm-9"},z={key:0},M={key:1},Z={class:"row"},N=(0,s._)("div",{class:"col-12 col-sm-3"},[(0,s._)("span",null,"Total Point")],-1),T={class:"col-12 col-sm-9"},K={class:"d-flex justify-content-between align-items-center"},A={class:"text-gray-5"},B={class:"card"},V=(0,s._)("div",{class:"card-header"},[(0,s._)("h6",{class:"mb-0"},"Password")],-1),E={class:"card-body"},G={class:"row"},Y={class:"col-12"},X={class:"row"},J={class:"col-12"},Q=["disabled"],aa=(0,s._)("div",{class:"content-title"},[(0,s._)("h5",null,"Riwayat Point")],-1),ta={class:"row"},ea={class:"col-12"},sa={class:"card"},ia={class:"card-body"},ra={class:"row"},oa={class:"col-8"},da=(0,s._)("div",null,[(0,s._)("a",{class:"text-primary"},"Lihat Transaksi")],-1),na={class:"col-4 text-right"},la={key:0,class:"text-success"},ca={key:1,class:"text-danger"};function ma(a,t,e,I,D,ma){const ua=(0,s.up)("a-input"),ga=(0,s.up)("a-form-item"),ha=(0,s.up)("a-select"),pa=(0,s.up)("upload-image"),_a=(0,s.up)("a-switch"),fa=(0,s.up)("a-form"),wa=(0,s.up)("a-tag"),va=(0,s.up)("a-input-password"),ba=(0,s.up)("a-spin"),ka=(0,s.up)("a-empty");return(0,s.wg)(),(0,s.iD)("div",null,[r,(0,s.Wm)(ba,{spinning:a.loadingGet},{default:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s._)("div",d,[(0,s._)("div",n,[l,(0,s._)("div",c,[(0,s.Wm)(fa,{ref:"formRef",layout:"vertical",model:a.formState,rules:a.formRules,onFinish:a.handleEdit},{default:(0,s.w5)((()=>[(0,s._)("div",m,[(0,s._)("div",u,[(0,s.Wm)(ga,{ref:"name",label:"Nama",name:"name"},{default:(0,s.w5)((()=>[(0,s.Wm)(ua,{value:a.formState.name,"onUpdate:value":t[0]||(t[0]=t=>a.formState.name=t),placeholder:"Nama Petani"},null,8,["value"])])),_:1},512)])]),(0,s._)("div",g,[(0,s._)("div",h,[(0,s.Wm)(ga,{ref:"phone_number",label:"No HP",name:"phone_number"},{default:(0,s.w5)((()=>[(0,s.Wm)(ua,{value:a.formState.phone_number,"onUpdate:value":t[1]||(t[1]=t=>a.formState.phone_number=t),placeholder:"No HP"},null,8,["value"])])),_:1},512)])]),(0,s._)("div",p,[(0,s._)("div",_,[(0,s.Wm)(ga,{ref:"district_id",label:"Wilayah",name:"district_id"},{default:(0,s.w5)((()=>[(0,s.Wm)(ha,{ref:"select",style:{width:"100%"},placeholder:"Pilih wilayah",value:a.formState.district_id,"onUpdate:value":t[2]||(t[2]=t=>a.formState.district_id=t),"show-search":"",options:a.districtOptions,"filter-option":a.filterOption},null,8,["value","options","filter-option"])])),_:1},512)])]),(0,s._)("div",f,[(0,s._)("div",w,[(0,s.Wm)(ga,{ref:"address",label:"Alamat",name:"address"},{default:(0,s.w5)((()=>[(0,s.Wm)(ua,{value:a.formState.address,"onUpdate:value":t[3]||(t[3]=t=>a.formState.address=t),placeholder:"Alamat lengkap"},null,8,["value"])])),_:1},512)])]),(0,s._)("div",v,[(0,s._)("div",b,[(0,s.Wm)(ga,{ref:"latitude",label:"Latitude",name:"latitude"},{default:(0,s.w5)((()=>[(0,s.Wm)(ua,{value:a.formState.latitude,"onUpdate:value":t[4]||(t[4]=t=>a.formState.latitude=t),placeholder:"Latitude"},null,8,["value"])])),_:1},512)]),(0,s._)("div",k,[(0,s.Wm)(ga,{ref:"longitude",label:"Longitude",name:"longitude"},{default:(0,s.w5)((()=>[(0,s.Wm)(ua,{value:a.formState.longitude,"onUpdate:value":t[5]||(t[5]=t=>a.formState.longitude=t),placeholder:"Longitude"},null,8,["value"])])),_:1},512)])]),(0,s._)("div",S,[(0,s._)("div",P,[(0,s.Wm)(ga,{ref:"image",label:"Foto",name:"image"},{default:(0,s.w5)((()=>[(0,s.Wm)(pa,{"img-url":a.imageUrl,onChangeImg:a.onChangeImg},null,8,["img-url","onChangeImg"])])),_:1},512)]),(0,s._)("div",y,[(0,s.Wm)(ga,{ref:"resident_card_image",label:"Foto KTP",name:"resident_card_image"},{default:(0,s.w5)((()=>[(0,s.Wm)(pa,{"img-url":a.residentCardImageUrl,onChangeImg:a.onChangeResidentImg},null,8,["img-url","onChangeImg"])])),_:1},512)]),(0,s._)("div",F,[(0,s.Wm)(ga,{label:"Status"},{default:(0,s.w5)((()=>[(0,s.Wm)(_a,{checked:1===a.formState.status_id,"checked-children":"Aktif","un-checked-children":"Nonaktif",onChange:a.onStatusChange},null,8,["checked","onChange"])])),_:1})])]),(0,s._)("div",C,[(0,s._)("div",W,[(0,s._)("button",{type:"submit",class:"btn btn-primary btn-with-addon",disabled:a.loadingSubmit},q,8,U)])])])),_:1},8,["model","rules","onFinish"])])])]),(0,s._)("div",L,[(0,s._)("div",O,[x,(0,s._)("div",R,[(0,s._)("div",j,[$,(0,s._)("div",H,[2===a.additionalData?.status_id?((0,s.wg)(),(0,s.iD)("div",z,[(0,s.Wm)(wa,{color:"red"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(a.additionalData.status_caption),1)])),_:1})])):(0,s.kq)("",!0),1===a.additionalData?.status_id?((0,s.wg)(),(0,s.iD)("div",M,[(0,s.Wm)(wa,{color:"green"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(a.additionalData.status_caption),1)])),_:1})])):(0,s.kq)("",!0)])]),(0,s._)("div",Z,[N,(0,s._)("div",T,[(0,s._)("div",K,[(0,s._)("span",A,(0,i.zw)(a.additionalData?.total_point),1)])])])])]),(0,s._)("div",B,[V,(0,s._)("div",E,[(0,s.Wm)(fa,{layout:"vertical",ref:"passwordFormRef",model:a.passwordFormState,rules:a.passwordRules,onFinish:a.handleChangePassword},{default:(0,s.w5)((()=>[(0,s._)("div",G,[(0,s._)("div",Y,[(0,s.Wm)(ga,{ref:"password",label:"Password",name:"password"},{default:(0,s.w5)((()=>[(0,s.Wm)(va,{value:a.passwordFormState.password,"onUpdate:value":t[6]||(t[6]=t=>a.passwordFormState.password=t),placeholder:"Password"},null,8,["value"])])),_:1},512)])]),(0,s._)("div",X,[(0,s._)("div",J,[(0,s.Wm)(ga,{ref:"password_confirmation",label:"Konfirmasi Password",name:"password_confirmation"},{default:(0,s.w5)((()=>[(0,s.Wm)(va,{value:a.passwordFormState.password_confirmation,"onUpdate:value":t[7]||(t[7]=t=>a.passwordFormState.password_confirmation=t),placeholder:"Konfirmasi Password"},null,8,["value"])])),_:1},512)])]),(0,s._)("button",{type:"submit",class:"btn btn-primary",disabled:a.loadingChangePassword}," Simpan Password ",8,Q)])),_:1},8,["model","rules","onFinish"])])])])])])),_:1},8,["spinning"]),aa,(0,s.Wm)(ba,{spinning:a.loadingPointLogs},{default:(0,s.w5)((()=>[(0,s._)("div",ta,[(0,s._)("div",ea,[(0,s._)("div",sa,[(0,s._)("div",ia,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.pointLogs,(a=>((0,s.wg)(),(0,s.iD)("div",{key:a.id,class:"px-3 py-4 border-bottom border-light"},[(0,s._)("div",ra,[(0,s._)("div",oa,[(0,s._)("span",null,(0,i.zw)(a.description),1),da]),(0,s._)("div",na,[a.qty_point>0?((0,s.wg)(),(0,s.iD)("span",la," +"+(0,i.zw)(a.qty_point),1)):((0,s.wg)(),(0,s.iD)("span",ca,(0,i.zw)(a.qty_point),1))])])])))),128)),a.pointLogs?.length||a.loadingPointLogs?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(ka,{key:0,description:"Belum ada transaksi reward"}))])])])])])),_:1},8,["spinning"])])}e(6699);var ua=e(4870),ga=e(1789),ha=e(7776),pa=e(8726),_a=e(7417),fa=(0,s.aZ)({name:"EditFarmer",props:{id:String},components:{UploadImage:ha.Z},setup(){const a=(0,_a.oR)(),t=(0,s.Fl)((()=>a.getters["Setting/settings"])),e=(0,ua.iH)(),i=(0,ua.qj)({password:void 0,password_confirmation:void 0}),r=async(a,t)=>""===t?Promise.reject("Konfirmasi password tidak boleh kosong."):t!==i.password?Promise.reject("Password dan Konfirmasi password harus sama."):Promise.resolve(),o={password:[{required:!0,trigger:"change",message:"Password tidak boleh kosong"}],password_confirmation:[{required:!0,trigger:"change",validator:r}]},d=(0,ua.iH)(),n=(0,ua.qj)({name:void 0,address:void 0,be_farmer_id:void 0,district_id:void 0,latitude:void 0,longitude:void 0,password:void 0,password_confirmation:void 0,phone_number:void 0,image:void 0,resident_card_image:void 0,status_id:void 0}),l={name:[{required:!0,trigger:"change",message:"Nama tidak boleh kosong"}],phone_number:[{required:!0,trigger:"change",message:"No HP tidak boleh kosong"}],address:[{required:!0,trigger:"change",message:"Alamat tidak boleh kosong"}],latitude:[{required:!0,trigger:"change",message:"Latitude tidak boleh kosong"}],longitude:[{required:!0,trigger:"change",message:"Longitude tidak boleh kosong"}],district_id:[{required:!0,trigger:"change",message:"Wilayah tidak boleh kosong"}],image:[{required:!0,message:"Foto tidak boleh kosong",trigger:"blur"}],resident_card_image:[{required:!0,message:"Foto KTP tidak boleh kosong",trigger:"blur"}],password:[{required:!0,trigger:"change",message:"Password tidak boleh kosong"}],password_confirmation:[{required:!0,trigger:"change",validator:r}]},c=(0,ua.iH)(""),m=(0,ua.iH)(""),u=(a,t)=>{c.value=a,n.image=t,d.value?.validateFields("image")},g=(a,t)=>{m.value=a,n.resident_card_image=t,d.value?.validateFields("resident_card_image")},h=(a,t)=>t.label.toLowerCase().includes(a.toLocaleLowerCase());return{formRef:d,formState:n,formRules:l,imageUrl:c,residentCardImageUrl:m,passwordFormRef:e,passwordFormState:i,passwordRules:o,setting:t,onChangeImg:u,onChangeResidentImg:g,filterOption:h}},data(){return{districts:[],farmer:void 0,pointLogs:void 0,loadingSubmit:!1,loadingGet:!0,loadingChangePassword:!1,additionalData:null,loadingPointLogs:!0}},computed:{districtOptions(){return this.districts.map((a=>({value:a.id,label:a.name})))}},mounted(){this.fetchFarmer(),this.fetchDistricts(),this.fetchPointLogs()},methods:{async fetchDistricts(){const a=await(0,ga.w9)();a.data.success&&(this.districts=a.data.data)},async fetchFarmer(){this.loadingGet=!0;const a=await(0,pa.T)(this.$props.id);a.data.success&&(this.farmer=a.data.data,this.formState.name=a.data.data.name,this.formState.address=a.data.data.address,this.formState.latitude=a.data.data.latitude,this.formState.longitude=a.data.data.longitude,this.formState.phone_number=a.data.data.phone_number,this.formState.district_id=a.data.data.district.id,this.formState.image=a.data.data.image_url,this.formState.resident_card_image=a.data.data.resident_card_image_url,this.imageUrl=a.data.data.image_url,this.residentCardImageUrl=a.data.data.resident_card_image_url,this.formState.status_id=a.data.data.status_id,this.additionalData={total_point:a.data.data.total_point,status_id:a.data.data.status_id,status_caption:a.data.data.status_caption}),this.loadingGet=!1},async fetchPointLogs(){this.loadingPointLogs=!0;const a=await(0,pa.mt)(this.$props.id);a.data.success&&(this.pointLogs=a.data.data),this.loadingPointLogs=!1},async onSubmit(){const a=new FormData;for(let e in this.formState)"district_id"!==e?"image"!==e?"resident_card_image"!==e?this.formState[e]!==this.farmer[e]&&a.append(e,this.formState[e]):this.formState.resident_card_image!==this.farmer.resident_card_image_url&&a.append(e,this.formState[e]):this.formState.image!==this.farmer.image_url&&a.append(e,this.formState[e]):this.formState.district_id!==this.farmer.district.id&&a.append(e,this.formState[e]);const t=await(0,pa.fP)(this.$props.id,a);t.data.success&&(this.farmer=t.data.data,this.formState.name=t.data.data.name,this.formState.address=t.data.data.address,this.formState.latitude=t.data.data.latitude,this.formState.longitude=t.data.data.longitude,this.formState.phone_number=t.data.data.phone_number,this.formState.district_id=t.data.data.district.id,this.formState.image=t.data.data.image_url,this.formState.resident_card_image=t.data.data.resident_card_image_url,this.imageUrl=t.data.data.image_url,this.residentCardImageUrl=t.data.data.resident_card_image_url,this.additionalData={total_point:t.data.data.total_point,status_id:t.data.data.status_id,status_caption:t.data.data.status_caption})},async submitChangePassword(){this.loadingChangePassword=!0;const a=await(0,pa.fP)(this.$props.id,{password:this.passwordFormState.password,password_confirmation:this.passwordFormState.password_confirmation});a.data.success&&this.passwordFormRef.resetFields(),this.loadingChangePassword=!1},handleChangePassword(){this.passwordFormRef.validateFields().then((()=>{this.submitChangePassword()})).catch((()=>{}))},handleEdit(){this.formRef.validateFields().then((()=>this.onSubmit())).catch((()=>{}))},onStatusChange(a){this.formState.status_id=a?1:2}}}),wa=e(89);const va=(0,wa.Z)(fa,[["render",ma]]);var ba=va}}]);